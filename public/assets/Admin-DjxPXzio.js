import{j as e,m as M}from"./framer-motion-BNS4bMWx.js";import{a as l}from"./react-vendor-4eAfVF2H.js";import{L as R,A as T}from"./AnimatedText-D0yN60be.js";import{c as y,b as c,a as A}from"./index-gBBpIKLR.js";import{B as j}from"./button-vQVSgPVY.js";import{C as S}from"./circle-check-big-Db3Y0brk.js";import"./ui-vendor-F0KbswVc.js";import"./charts-vendor-DZSF9qVU.js";import"./query-vendor-D8jaLRQL.js";const E=y("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);const _=y("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);const C=y("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),w=l.forwardRef(({className:a,...t},r)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:r,className:c("w-full caption-bottom text-sm",a),...t})}));w.displayName="Table";const v=l.forwardRef(({className:a,...t},r)=>e.jsx("thead",{ref:r,className:c("[&_tr]:border-b",a),...t}));v.displayName="TableHeader";const k=l.forwardRef(({className:a,...t},r)=>e.jsx("tbody",{ref:r,className:c("[&_tr:last-child]:border-0",a),...t}));k.displayName="TableBody";const D=l.forwardRef(({className:a,...t},r)=>e.jsx("tfoot",{ref:r,className:c("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...t}));D.displayName="TableFooter";const b=l.forwardRef(({className:a,...t},r)=>e.jsx("tr",{ref:r,className:c("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...t}));b.displayName="TableRow";const i=l.forwardRef(({className:a,...t},r)=>e.jsx("th",{ref:r,className:c("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...t}));i.displayName="TableHead";const m=l.forwardRef(({className:a,...t},r)=>e.jsx("td",{ref:r,className:c("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...t}));m.displayName="TableCell";const L=l.forwardRef(({className:a,...t},r)=>e.jsx("caption",{ref:r,className:c("mt-4 text-sm text-muted-foreground",a),...t}));L.displayName="TableCaption";const g={async getAllMessages(){return{data:[],error:null}},async insertMessage(a){return{data:{...a,id:`temp-${Date.now()}`,created_at:new Date().toISOString(),is_read:!1},error:null}},async markAsRead(a){return{data:{id:a,name:"",email:"",subject:"",message:"",user_id:null,created_at:new Date().toISOString(),is_read:!0},error:null}},async deleteMessage(a){return{error:null}}},B=()=>{const[a,t]=l.useState([]),[r,x]=l.useState(!0),[p,o]=l.useState(null),h=async()=>{try{x(!0);const{data:n,error:s}=await g.getAllMessages();if(s)throw s;t(n||[]),o(null)}catch(n){o(n instanceof Error?n.message:"Unknown error")}finally{x(!1)}};return l.useEffect(()=>{h()},[]),{messages:a,loading:r,error:p,fetchMessages:h,markAsRead:async n=>{try{const{error:s}=await g.markAsRead(n);if(s)throw s;t(d=>d.map(u=>u.id===n?{...u,is_read:!0}:u))}catch(s){o(s instanceof Error?s.message:"Unknown error")}},deleteMessage:async n=>{try{const{error:s}=await g.deleteMessage(n);if(s)throw s;t(d=>d.filter(u=>u.id!==n))}catch(s){o(s instanceof Error?s.message:"Unknown error")}}}},q=()=>{const[a,t]=l.useState(null),{toast:r}=A(),{messages:x,loading:p,error:o,markAsRead:h}=B();l.useEffect(()=>{localStorage.getItem("isAdmin")==="true"||localStorage.setItem("isAdmin","true")},[]);const f=async s=>{try{await h(s.id),a?.id===s.id&&t({...a,is_read:!0}),r({title:s.is_read?"Marked as unread":"Marked as read",variant:"default"})}catch(d){r({title:"Error updating message",description:d instanceof Error?d.message:"Unknown error",variant:"destructive"})}},N=s=>{t(s),s.is_read||f(s)},n=s=>{const d=new Date(s);return d.toLocaleDateString()+" "+d.toLocaleTimeString()};return e.jsx(R,{children:e.jsx("section",{className:"pt-32 pb-16",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center mb-16",children:[e.jsx("span",{className:"inline-block py-1 px-3 rounded-full text-xs font-medium bg-brand-purple/10 text-brand-purple mb-4",children:"Admin Panel"}),e.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-6",children:e.jsx(T,{text:"Contact Messages",once:!0})}),e.jsx("div",{className:"max-w-3xl mx-auto",children:e.jsx("p",{className:"text-lg text-muted-foreground",children:"Manage and respond to messages from your contact form."})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"glass-panel p-6 rounded-lg overflow-hidden",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"All Messages"}),p?e.jsx("div",{className:"flex justify-center items-center py-10",children:e.jsx("div",{className:"animate-spin h-8 w-8 border-2 border-brand-purple border-t-transparent rounded-full"})}):o?e.jsx("div",{className:"text-center py-10 text-red-500",children:o}):x.length===0?e.jsx("div",{className:"text-center py-10 text-muted-foreground",children:"No messages yet."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(w,{children:[e.jsx(v,{children:e.jsxs(b,{children:[e.jsx(i,{className:"w-[100px]",children:"Status"}),e.jsx(i,{children:"From"}),e.jsx(i,{children:"Subject"}),e.jsx(i,{children:"Date"}),e.jsx(i,{className:"text-right",children:"Actions"})]})}),e.jsx(k,{children:x.map(s=>e.jsxs(b,{className:s.is_read?"":"bg-secondary/50 font-medium",children:[e.jsx(m,{children:s.is_read?e.jsx(S,{className:"h-4 w-4 text-green-500"}):e.jsx(E,{className:"h-4 w-4 text-amber-500"})}),e.jsx(m,{children:s.name}),e.jsx(m,{children:s.subject}),e.jsx(m,{children:n(s.created_at)}),e.jsxs(m,{className:"text-right",children:[e.jsx(j,{variant:"ghost",size:"sm",onClick:()=>N(s),children:"View"}),e.jsx(j,{variant:"ghost",size:"sm",onClick:()=>f(s),children:s.is_read?e.jsx(_,{className:"h-4 w-4"}):e.jsx(C,{className:"h-4 w-4"})})]})]},s.id))})]})})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"glass-panel p-6 rounded-lg sticky top-24",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Message Details"}),a?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"From"}),e.jsxs("p",{className:"font-medium",children:[a.name," (",a.email,")"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Subject"}),e.jsx("p",{className:"font-medium",children:a.subject})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Date"}),e.jsx("p",{children:n(a.created_at)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Message"}),e.jsx("div",{className:"p-4 bg-secondary/50 rounded-md mt-1",children:e.jsx("p",{children:a.message})})]}),e.jsx("div",{className:"pt-2",children:e.jsx(j,{className:"w-full",onClick:()=>window.location.href=`mailto:${a.email}?subject=RE: ${a.subject}`,children:"Reply via Email"})})]}):e.jsx("div",{className:"text-center py-10 text-muted-foreground",children:"Select a message to view details"})]})})]})]})})})};export{q as default};
